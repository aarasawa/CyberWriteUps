# Primary Knowledge - Very Easy

### Description
> Surrounded by an untamed forest and the serene waters of the Primus river, your sole objective is surviving for 24 hours. Yet, survival is far from guaranteed as the area is full of Rattlesnakes, Spiders and Alligators and the weather fluctuates unpredictably, shifting from scorching heat to torrential downpours with each passing hour. Threat is compounded by the existence of a virtual circle which shrinks every minute that passes. Anything caught beyond its bounds, is consumed by flames, leaving only ashes in its wake. As the time sleeps away, you need to prioritise your actions secure your surviving tools. Every decision becomes a matter of life and death. Will you focus on securing a shelter to sleep, protect yourself against the dangers of the wilderness, or seek out means of navigating the Primusâ€™ waters?

### 1. 
> The flag is encrypted through being piped into a couple mathematical functions. Learning some new things about encryption with this one. First, RSA encryption. The python script is encrypting the flag using a byte-to-long conversion, then using the power function they encrypt the flag using two prime numbers. One generated using python and the other a common public exponent. The tricky part is understanding the algorithm to undo it, since I have not encountered it before. 

### RSA Encryption
> According the Wiki, we start by computing the product of two prime numbers lets call it n = p x q. Then comes calculating something called the Carmichael totient function of the product. It sounds complicated but the computation is pretty easy if the prime numbers in the initial computations are small. You take the least common multiple or LCM of the prime numbers after subtracting 1 from both of them. The function is referred to as the lambda(pq) = LCM(p-1, q-1). Then it comes to choosing a coprime which is between 2 and the Carmichael totient function number you just computed. Next, compute the modular multiplicative inverse (MMI) of e, we will call d. The MMI means that to find some number d such that d x e % lambda(pq). 

### Modular Multiplicative Inverse
> Let's say we want to calculate the MMI of e, from algebra we would think of this number as e^(-1). To calculate d, we use MMI of e and the totient. This requires the use of the Extended Euclidean Algorithm, which gives us coefficients x and y that make this expression: ax + by = gcd(a, b) equivalent. 

### 1. 
> Given that the operations given in the python script are to encrypt the flag. We need to the reverse this to find the flag. We first need to find the private exponent, d. We are provided with a public exponent, e, the product of prime numbers, p, and c is the calculated ciphertext. To find our private exponent, we have to first calculate the totient which subtracts 1 from both prime numbers and takes the product. Then find the MMI of the public exponent and totient. The decrypted message can then be found by calculating pow(out_c, out_d, and out_n). The answer is in bytes so we decode back to utf-8. 